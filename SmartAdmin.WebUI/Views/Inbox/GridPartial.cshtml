@using PagedList.Mvc;
@model PagedList.IPagedList<SmartAdmin.WebUI.ModelView.MensagemModelView>

 @if (Model.Count == 0)
 {
    <div class="alert alert-warning no-margin fade in">
        <i class="fa-fw fa fa-info"></i>
        Não existem mensagem em sua caixa de entrada!
    </div>
 }
 else
 {
    <table id="inbox-table" class="table table-striped table-hover">
        <tbody>
            @for (int i = 0; i < Model.Count; i++)
            {
                <tr id="@(Model[i].MensagemId)" @((Model[i].MensagemLida == false) ? "class=unread" : string.Empty)>
                <td class="inbox-table-icon">
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" class="checkbox style-2" id="@(Model[i].MensagemChecked)" name="@(Model[i].MensagemChecked)" @((Model[i].MensagemChecked==true) ? "checked" : string.Empty)>
                            <span></span>
                        </label>
                    </div>
                </td>
                <td class="inbox-data-from hidden-xs hidden-sm">
                    <div>
                        @(Model[i].MensagemAutor.NOME)
                    </div>
                </td>
                <td class="inbox-data-message">
                    <div>
                        @(Model[i].MensagemTitulo)
                    </div>
                </td>
                <td class="inbox-data-attachment hidden-xs">
                    <div>
                    </div>
                </td>
                <td class="inbox-data-date hidden-xs text-center" style="width:150px;">
                    <div>
                        @(Model[i].MensagemDataEnvio)
                    </div>
                </td>
            </tr>                 
            }
            


        </tbody>
    </table>
 }
<script>

    //Gets tooltips activated
    $("#inbox-table [rel=tooltip]").tooltip();

    $("#inbox-table input[type='checkbox']").change(function () {
        $(this).closest('tr').toggleClass("highlight", this.checked);
    });

    $("#inbox-table .inbox-data-message").click(function () {
        $this = $(this);
        getMail($this);
    })
    $("#inbox-table .inbox-data-from").click(function () {
        $this = $(this);
        getMail($this);
    })
    function getMail($this) {
        //console.log($this.closest("tr").attr("id"));
        loadURL("ajax/email-opened.html", $('#inbox-content > .table-wrap'));
    }


    $('.inbox-table-icon input:checkbox').click(function () {
        enableDeleteButton();
    })

    $(".deletebutton").click(function () {
        $('#inbox-table td input:checkbox:checked').parents("tr").rowslide();
        //$(".inbox-checkbox-triggered").removeClass('visible');
        //$("#compose-mail").show();
    });

    function enableDeleteButton() {
        var isChecked = $('.inbox-table-icon input:checkbox').is(':checked');

        if (isChecked) {
            $(".inbox-checkbox-triggered").addClass('visible');
            //$("#compose-mail").hide();
        } else {
            $(".inbox-checkbox-triggered").removeClass('visible');
            //$("#compose-mail").show();
        }
    }

</script>